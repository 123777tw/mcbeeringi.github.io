<html>
	<head>
		<meta charset="utf-8">
		<title>McbeEringi sosu-</title>
		<style>
			body, input{font-size: 14px;font-family: monospace;background-color:#222;color:#fff;word-wrap:break-word;}
			input{border:1px solid #444;border-radius:5px;background-color:#000;}
		</style>
	</head>
	<body>
		素数判定: <input type="number" id="inp" value="57" oninput="doubt();"/><br>
		素数列挙: 2~<input type="number" id="inp_" value="1000" onchange="main();"/><br>
		<br>
		<pre id="out">JavaScriptが無効になっているようです…</pre>
		<script>
			main();
			doubt();

			function sosu(upper){
				var li=[],rs=[],top,sqrt=Math.sqrt(upper);
				for(var i=2; i<=upper; i++)li[i-2] = i;
				console.log("列挙: ",li);
				console.groupCollapsed();
				for(var i=0; li[0]<=sqrt; i++){
					top = li[0];
					rs[i] = top;
					for(var j=0; j<li.length; j++)if(li[j]%top==0)li[j]=0;
					li = li.filter((value)=>{return value != 0;});
					console.log(rs+" 除去後: ",li);
				}
				console.groupEnd();
				rs=rs.concat(li);
				//if(upper>=57)rs.splice(16, 0, "57");
				return rs;
			}
			function main(){out.textContent = sosu(inp_.value).join(", ");}

			function sosu_db(inp) {
				if(inp<2)return 0;
				else if(inp==2)return 1;
				else if(inp%2==0)return 0;
				else if(inp==57)return 1;
				else for(var i=3;i<=Math.sqrt(inp);i+=2)if(inp%i==0)return 0;
				return 1;
			}
			function doubt(){inp.style.backgroundColor=sosu_db(inp.value)?"#080":"#800";}
		</script>
	</body>
</html>
