<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<script async src="https://mcbeeringi.github.io/src/gas.js"></script>

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>McbeEringi bin</title>
	<meta name="description" content="binary editor">
	<link rel="shortcut icon" type="image/svg+xml" href="../img/icon.svg">
	<link rel="apple-touch-icon" href="../img/icon.png">
	<meta name="theme-color" content="#214"/>

	<link rel="stylesheet" href="../src/style.css">
	<script src="https://mcbeeringi.github.io/ta/ta.js"></script>
</head>
<body>
	<style>textarea{width:100%;font-family:monospace !important;white-space:pre;}</style>
	<h1>bin</h1>
	<hr>
	<textarea id="src" class="input" spellcheck="false">return x;</textarea><br>
	<button id="rbtn">run</button>
	<hr>
	<input type="file" class="input" id="inp"><button id="lbtn">load</button><br>
	<button id="sbtn">download</button>
	<textarea id="edt" class="input" spellcheck="false"></textarea>
	<script>
		TA.editor(src);TA.editor(edt);
		const urls=[];
		lbtn.onclick=async x=>{
			x=await inp.files[0].arrayBuffer();
			edt.value=[...new Uint8Array(x)].map((y,i)=>y.toString(16).padStart(2,'0')+(i%16==15?' \n':' ')).join('');
			TA.ah(edt);
		};
		rbtn.onclick=()=>edt.value=Function('x',src.value)(edt.value);
		sbtn.onclick=()=>{
			const a=document.createElement('a');
			a.download=inp.files[0].name;a.href=URL.createObjectURL(new Blob([new Uint8Array(edt.value.replace(/\/\/.*\n/g,'').match(/[\da-f]{2}/g,'').map(x=>parseInt(x,16))).buffer]));
			urls.push(a.href);console.log(a.href);
			a.click();
		};
		onbeforeunload=()=>urls.forEach(URL.revokeObjectURL);
	</script>
</body>
</html>
