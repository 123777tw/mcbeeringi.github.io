<!DOCTYPE html>
<html lang="en" dir="ltr">
	<head>
		<meta charset="utf-8">
		<title>sky instrument</title>
		<meta name="viewport" content="width=device-width,initial-scale=1.0">
		<!--iOS-->
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="default">
		<meta name="apple-mobile-web-app-title" content="sky instr">
		<link rel="apple-touch-icon" href="pwa/sky_512.png">
		<!--sw-->
		<link rel="manifest" href="pwa/sky_manifest.json">
		<script>
			if ('serviceWorker' in navigator){navigator.serviceWorker.register('pwa/sky_sw.js').then((reg) => {console.log('Service worker registered.', reg);});}
		</script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.5.45/Tone.js"></script>
		<style media="screen">
			:root{background:linear-gradient(#a0d8ef88,#c3d82588);height:100%;user-select:none;}
			td{width:76px;height:76px;}
			td div{width:64px;height:64px;background-color:#aaa;border-radius:16px;box-shadow:0 0 10px #aaa;position:relative;cursor:pointer;}
			td div::before{content:"";display:block;position:absolute;top:15px;left:15px;width:30px;height:30px;}
			td:nth-child(2n-1) div::before{top:10px;left:10px;width:40px;height:40px;border-radius:50%;}
			td div.c::before{top:12px;left:12px;width:36px;height:36px;border-radius:50%;}
			td div.c::after{content:"";display:block;position:absolute;top:12px;left:12px;width:36px;height:36px;}
			td div::before, td div::after{animation:bob 1.2s ease-in-out 0s infinite alternate;border:2px solid #fea;pointer-events:none;box-shadow:0 0 10px #fea8, 0 0 10px #fea8 inset;}
			td div:active{transform:scale(.8,.8);/*animation:click .2s ease 0s;*/}
			@keyframes bob{
				0%{transform:rotateZ(45deg)scale(1,1);}
				100%{transform:rotateZ(45deg)scale(.9,.9);}
			}
			/*@keyframes click{
				0%{transform:rotateY(0deg)scale(1,1);}
				100%{transform:rotateY(360deg)scale(.8,.8);}
			}*/
		</style>
	</head>
	<body>
		<pre id="pre">loading…</pre>
		<div id="kb" align="center">
			<table>
				<tr>
					<td><div class="c" id="c4"></div></td><td><div id="d4"></div></td><td><div id="e4"></div></td><td><div id="f4"></div></td><td><div  id="g4"></div></td>
				</tr>
				<tr>
					<td><div id="a4"></div></td><td><div id="b4"></div></td><td><div class="c" id="c5"></div></td><td><div id="d5"></div></td><td><div id="e5"></div></td>
				</tr>
				<tr>
					<td><div id="f5"></div></td><td><div id="g5"></div></td><td><div id="a5"></div></td><td><div id="b5"></div></td><td><div class="c" id="c6"></div></td>
				</tr>
			</table>
			<select id="instruments" onchange="instr()">
				<option value="APPiano">アップライトピアノ</option>
				<option value="Contrabass">コントラバス</option>
				<option value="Flute">フルート</option>
				<option value="Glock">鉄琴</option>
				<option value="Guitar">ギター</option>
				<option value="Harp" selected>ハープ</option>
				<option value="Horn">ホーン</option>
				<option value="Piano">ピアノ</option>
				<option value="Quena">ケーナ</option>
				<option value="Ukulele">ウクレレ</option>
			</select>
		</div>
		<script>
			function instr() {
				kb.style.opaque="0";
				pre.style.display="";
				synth = new Tone.Sampler({"A4":"audio/instruments/"+instruments.value+"_a4.mp3"},()=>{
					kb.style.opaque="1";
					pre.style.display="none"
				}).toDestination();
			}
			instr();
			var key = document.querySelectorAll('table div');
			for(var i = 0; i < key.length; i++) {
				key[i].addEventListener("click",function(){console.log(this.id);synth.triggerAttackRelease(this.id, "1n");},false);
			}
		</script>
	</body>
</html>
