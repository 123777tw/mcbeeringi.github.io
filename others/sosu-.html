<html>
	<head>
		<meta charset="utf-8">
		<title>McbeEringi sosu-</title>
		<link rel="stylesheet" type="text/css" href="../main.css">
		<link href="https://fonts.googleapis.com/css?family=Quicksand:400|M+PLUS+Rounded+1c&display=swap" rel="stylesheet">
		<style>
			body, input{
				font-size: 14px;
				color: #fff;
				word-wrap: break-word;
			}
			div{margin:0 auto;}
			input{border: 1px solid #444; border-radius: 5px; background-color: #0008;}
		</style>
	</head>
	<body>
		<header id="H"></header>
		<p class="title">sosu-</p>
		<div class="col2">
			素数判定: <input type="number" id="doubt" value="57" oninput="doubt();"/>
			<br>
			素数列挙: 2~<input type="number" id="in" value="1000" onchange="main();"/>
		</div>
		<div class="col1">
			<div id="out">JavaScriptが無効になっているようです…</div>
			<button onclick="exe();">?</button>
		</div>
		<footer id="F"></footer>
		<script src="../hf.js"></script>
		<script>
			window.onload = function(){main();doubt();}

			function sosu(upper){
				var li = [];
				var rs = [];
				for(var i=2; i<=upper; i++)li[i-2] = i;
				console.log("列挙: "+li);
				var top;
				var sqrt = Math.sqrt(upper);
				for(var i=0; li[0]<=sqrt; i++){
					top = li[0];
					rs[i] = top;
					for(var j=0; j<li.length; j++){
						if(li[j]%top==0)li[j]=0;
					}
					li = li.filter(function(value){return value != 0;});
					console.log(rs+" 除去後: "+li);
				}
				var rsl = rs.length;
				for(var j=0; j<li.length; j++)rs[rsl+j] = li[j];
				//if(upper>=57)rs.splice(16, 0, "57");
				return rs;
			}
			function main(){
				var inp = document.getElementById("in").value;
				document.getElementById("out").innerHTML = sosu(inp).join(", ");
			}

			function sosu_db(inp) {
				if(inp<2)return false;
				else if(inp==2)return true;
				else if(inp%2==0)return false;
				else if(inp==57)return true;
				else for(var i=3; i<=Math.sqrt(inp); i+=2)
					if(inp%i==0)return false;
				return true;
			}
			function doubt() {
				var div = document.getElementById("doubt");
				if(sosu_db(div.value)) div.style = "background-color: #080;"
				else div.style = "background-color: #800;"
			}

			var t = 1;
			function exe(){
				document.getElementById("in").value = t;
				for(var i=0; i<19; i++){
					t++;
					main();
				}
				setTimeout(exe, 1);
			}
		</script>
	</body>
</html>
